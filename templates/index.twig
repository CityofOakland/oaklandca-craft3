{% extends '_layout' %}
{% set bannerImage = entry.banner %}

{% block content %}
  <div class="banner banner-home">
    <div class="container text-deep-green">
      <div class="z-10 o-1 relative mb-32 bg-white font-heading p-6 max-w-xs rounded-sm">
        <h1 class="font-extrabold text-4xl leading-tight"><span class="text-xl block">Welcome to</span> Oakland, California</h1>
        <p class="my-0">
          <b><a class="text-bright-green" href="/topics/oaklandlovelife" class="">#OaklandLoveLife</a></b>
        </p>
      </div>
      <img class="banner-image image-blur-{{ bannerImageBlur ?? 'none' }}" src="{{ bannerImage.one.url }}" style="object-position:{{ bannerImage.one.getFocalPoint('asCss') }};" alt="{{ bannerImage.one.title }}">
      <form action="{{ url('search') }}">
        <label for="home-search" class="hidden-visually">How can we help you today?</label>
        <div class="flex shadow relative text-bright-green z-0">
          <input type="search" id="home-search" class="w-full mb-0 text-sm rounded-sm rounded-r-none appearance-none p-4 leading-none flex-1 z-10 text-dark-gray md:text-lg" aria-label="Site Search" name="query" placeholder="How can we help you?" value="">
          <button type="submit" class="btn bg-bright-green text-white p-4 rounded-l-none z-10 relative flex items-center justify-center">
            <span class="hidden-visually">
              Search
            </span>
            {{ craft.inlin.er('/assets/img/icon-magnifier.svg') | replace('<svg ', '<svg class="h-auto w-auto z-20 fill-current" ') | raw }}
          </button>
        </div>
      </form>
    </div>
  </div>
  {% include '_partials/_elements/_page-alert' %}

  {# Begin Services #}
  {% if entry.highlightedServices | length %}
    <section class="bg-rotate">
      <div class="container">
        <h2 class="mt-0 mb-4 sm:flex-1 text-2xl sm:text-3xl">Services</h2>
        <div class="card-grid card-grid-tight">
          {% for entry in entry.highlightedServices.all() %}
            <a href="{{ entry.url }}" class="border-l-4 border-bright-green card-grid-button py-5 text-dark-green hover:text-white hover:bg-deep-green shadow-btn">{{ entry.title | raw }}</a>
          {% endfor %}
        </div>
        <p class="text-lg font-bold mb-0"><a href="/services" class="border-b-2 border-dark-green">All Services »</a></p>
      </div>
    </section>
  {% endif %}
  {# End Services #}

  {# Begin News #}
  <section class="bg-rotate">
    <div class="container">
      <div class="md:flex">
        <div class="md:border-medium-gray md:border-r md:pr-10 md:w-1/2 lg:w-2/3">
          <h2 class="mt-0 mb-4 sm:flex-1 text-2xl sm:text-3xl">News & Updates</h2>
          <div class="lg:flex lg:flex-col mt-8">
            {% for entry in entry.highlightedNews.all() %}
              {% if loop.first %}
                <article class="lg:flex lg:flex-row">
                  <figure class="lg:w-2/5 h-48 p-4 bg-celeste relative z-0 flex items-center justify-center">
                    {% if entry.newsImage | length %}
                      <img class="absolute inset-0 object-fit-cover w-full h-full" src="{{ entry.newsImage.one.url }}" alt="{{ entry.newsImage.title }}"> 
                    {% else %}
                      <div class="text-camouflage-green opacity-75 fill-current h-full w-full py-6 px-12">
                        {{ craft.inlin.er('/assets/img/icon-newspaper.svg') | replace('<svg ', '<svg class="h-32 w-32" ') | raw }}
                      </div>
                    {% endif %}
                  </figure>
                  <div class="flex-1 lg:pl-12">
                    <date class="my-4 lg:mt-0 block text-sm tracking-widest uppercase text-camouflage-green">{{ entry.postDate | date('M j, Y') }}</date>
                    <h3 class="my-0 leading-tight text-xl md:text-2xl"><a href="{{ entry.url }}">{{ entry.title }}</a></h3>
                    {{ entry.summary | md }}
                  </div>
                </article>
              {% else %}
                <article class="my-2">
                  <h3 class="my-0 font-normal text-base font-body">
                    <a class="flex-1 hover:underline" href="{{ entry.url }}">{{ entry.title }}</a>
                  </h3>
                </article>
              {% endif %}
            {% endfor %}
          </div>
          <p class="text-lg font-bold mb-0"><a href="/departments/media-center" class="border-b-2 border-dark-green">Newsroom »</a></p>
        </div>
        <div class="mt-8 md:mt-0 md:border-medium-gray md:border-l md:pl-10 md:w-1/2 lg:w-1/3">
          <h2 class="mt-0 mb-4 sm:flex-1 text-2xl sm:text-3xl">Upcoming Events</h2>
          {% set options = {
            calendar: "events",
            limit: 1,
            featureOnHomepage: true,
            rangeStart: now | date('Y-m-d'),
          } %}
          {% set event = craft.calendar.events(options).one() %}
          {% if event | length %}
            {% set title = event.title %}
            {% set url = event.url %}
            {% set icon = 'calendar' %}
            {% set photo = event.eventImage.one ?? '' %}
            {% set byline = event.startDate.format("M d, Y") %}
            {% set body = event.body | chop(limit=25, unit='w', append='…') %}
            <article class="mt-8">
              <figure class="w-full h-48 p-4 bg-celeste relative z-0 flex items-center justify-center">
                {% if photo | length %}
                  <img src="{{ photo.url }}" class="absolute inset-0 object-fit-cover w-full h-full" alt="{{ photo.altText ?? ''}}">
                {% elseif icon is defined %}
                  <div class="text-camouflage-green opacity-75 fill-current h-full p-12">
                    {{ craft.inlin.er('/assets/img/icon-' ~ icon ~ '.svg') | replace('<svg ', '<svg class="h-full" ') | raw }}
                  </div>
                {% endif %}
              </figure>
              <div class="mt-4 text-base text-camouflage-green">{{ byline }}</div>
              <h3 class="text-xl md:text-2xl mt-4">
                <a href="{{ url }}">{{ title }}</a>
              </h3>
              <div class="text-shark mt-4 overflow-x-hidden">
                {{ body }}
              </div>
            </article>
          {% else %}
            <h3 class="text-xl md:text-2xl mt-4">
              Stay tuned
            </h3>
            <div class="text-shark mt-4">
              <p>There are no upcoming events at this time.</p>
            </div>
          {% endif %}
          <p class="text-lg font-bold mb-0"><a href="/events" class="border-b-2 border-dark-green">All Events »</a></p>
        </div>
      </div>
    </div>
  </section>

  {% if entry.learnMoreAbout | length %}
    <section class="bg-rotate">
      <div class="container">
        <h2 class="mt-0 mb-4 sm:flex-1 text-2xl sm:text-3xl">Learn More About</h2>
        <div class="card-grid card-grid-2up">
          {% for entry in entry.learnMoreAbout.all() %}
            <a href="{{ entry.url }}" class="border-l-4 border-bright-green card-grid-button py-5 text-dark-green hover:text-white hover:bg-deep-green shadow-btn">{{ entry.title | raw }}</a>
          {% endfor %}
        </div>
      </div>
    </section>
  {% endif %}

  {# Begin Officials #}
  <section class="bg-rotate">
    <div class="container">
      <h2 class="mt-0 mb-4 sm:flex-1 text-2xl sm:text-3xl">City Officials</h2>
      <div class="card-grid grid-equal-height profile-cards mt-12">
        {% for entry in craft.entries.section('officials').all() %}
          {% include '_partials/_elements/_profile-cards' with {
            photo: entry.portrait.one,
            name: entry.groupHeadName,
            jobTitle: entry.title,
            url: entry.redirectUrl ?? entry.url ?? ''
          } %}
        {% endfor %}
      </div>
      <p class="text-lg font-bold mb-0"><a href="http://gisapps.mapoakland.com/councildistricts" class="border-b-2 border-dark-green">Find your council district »</a></p>
    </div>
  </section>
  {# End Officials #}
{% endblock %}
